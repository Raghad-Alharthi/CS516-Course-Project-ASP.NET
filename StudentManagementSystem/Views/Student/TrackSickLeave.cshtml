@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Sick Leave Status";
    var status = (string)ViewBag.Attendance.SickLeaveStatus;
    var filePath = (string)ViewBag.Attendance.SickLeaveFile;
}

<div class="container my-5">
    <div class="card" style="border-radius: 12px; padding: 24px; background-color: #F1EFEC; box-shadow: 0 0 15px rgba(0, 0, 0, 0.05);">
        <!-- Title -->
        <h3 style="font-family: Funnel Display; color: #123458; font-weight: 800;">
            <i class="bi bi-clipboard-heart me-2"></i> Sick Leave Status
        </h3>
        <p class="mt-2" style="font-family: Funnel Display; color: #123458;">
            For Lecture on <strong>@ViewBag.Attendance.Lecture.LectureDateTime.ToString("yyyy-MM-dd hh:mm tt")</strong>
        </p>

        <!-- Status Badge -->
        <div class="mb-3">
            <span style="font-family: Funnel Display; font-size: 1.1rem; color: #123458;">Status:</span>
            @if (status == "Pending")
            {
                <span class="badge bg-warning text-dark ms-2" style="font-family: Funnel Display;"><i class="bi bi-hourglass-split me-1"></i>Pending</span>
            }
            else if (status == "Accepted")
            {
                <span class="badge bg-success ms-2" style="font-family: Funnel Display;"><i class="bi bi-check-circle me-1"></i>Approved</span>
            }
            else if (status == "Rejected")
            {
                <span class="badge bg-danger ms-2" style="font-family: Funnel Display;"><i class="bi bi-x-circle me-1"></i>Rejected</span>
            }
        </div>
        
        @if (ViewBag.Attendance.SickLeaveStatus == "Rejected" && !string.IsNullOrEmpty(ViewBag.Attendance.SickLeaveComment))
        {
            <div class="alert alert-warning mt-3">
                <strong>Rejection Reason:</strong> @ViewBag.Attendance.SickLeaveComment
            </div>
        }

        <!-- File Link -->
        @if (!string.IsNullOrEmpty(filePath))
        {
            <p style="font-family: Funnel Display; color: #123458;">
                <i class="bi bi-file-earmark-text me-1"></i>
                Uploaded File: 
                <a href="@filePath" target="_blank" style="color: #123458; text-decoration: underline;">
                    View Document
                </a>
            </p>
        }

        <!-- Re-upload Form -->
        @if (status == "Rejected")
        {
            <hr />
            <h5 class="mt-4" style="font-family: Funnel Display; color: #123458;">
                <i class="bi bi-upload me-2"></i> Re-upload Sick Leave Document
            </h5>

            <form method="post" asp-action="SubmitSickLeave" enctype="multipart/form-data" class="mt-3">
                <input type="hidden" name="attendanceId" value="@ViewBag.Attendance.AttendanceID" />

                <div class="mb-3">
                    <input type="file" name="sickLeaveFile" required class="form-control"
                           style="background-color: #f8f7f6; font-family: Funnel Display; color: #123458;" />
                </div>

                <button type="submit"
                        class="btn btn-warning"
                        style="font-family: Funnel Display; border-color: #c99400;">
                    <i class="bi bi-arrow-repeat me-1"></i> Resubmit
                </button>
            </form>
        }
    </div>
</div>
